<form [formGroup]="searchForm">
  <div class="flex-center-column-container">
    <mat-form-field>
      <mat-label>Start City</mat-label>
      <input formControlName="startCity" matInput />
      <mat-error *ngIf="searchForm.get('startCity')?.hasError('required')">
        You must select a city from the list.
      </mat-error>
    </mat-form-field>

    <div
      *ngIf="startCities.length > 0 && showStartCityList"
      class="city-list-container"
    >
      <mat-list>
        <mat-list-item
          *ngFor="let startCity of startCities"
          (click)="onStartCitySelected(startCity)"
        >
          {{ startCity }}
        </mat-list-item>
      </mat-list>
    </div>

    <mat-form-field>
      <mat-label>Destination City</mat-label>
      <input formControlName="destinationCity" matInput />
      <mat-error
        *ngIf="searchForm.get('destinationCity')?.hasError('required')"
      >
        You must select a city from the list.
      </mat-error>
    </mat-form-field>

    <div
      *ngIf="destinationCities.length > 0 && showDestinationCityList"
      class="city-list-container"
    >
      <mat-list>
        <mat-list-item
          *ngFor="let destinationCity of destinationCities"
          (click)="onDestinationCitySelected(destinationCity)"
        >
          {{ destinationCity }}
        </mat-list-item>
      </mat-list>
    </div>

    <mat-form-field>
      <mat-label>Choose a date</mat-label>
      <input matInput [matDatepicker]="picker" formControlName="selectedDate">
      <mat-hint>DD-MM-YYYY</mat-hint>
      <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
      <mat-datepicker #picker ></mat-datepicker>
    </mat-form-field>

    <mat-card-actions>
      <button
        mat-raised-button
        color="primary"
        (click)="handleSearchRides()"
        [disabled]="!searchForm.valid"
      >
        Search
      </button>
    </mat-card-actions>


    <mat-card *ngFor="let ride of searchedRides">
      <mat-card-header>
        <mat-card-title>Ride Details</mat-card-title>
      </mat-card-header>
      <mat-card-content (click)="onRideClick(ride.id)">
        <p><strong>Driver:</strong> {{ ride.driver.email }}</p>
        <p><strong>Start City:</strong> {{ ride.startAddress.street.city.cityName }}</p>
        <p><strong>Destination City:</strong> {{ ride.destinationAddress.street.city.cityName }}</p>
        <p><strong>Earliest Departure Time:</strong> {{ ride.earliestDepartureTime | date: 'HH:mm'}}</p>
      </mat-card-content>
    </mat-card>



  </div>
</form>
